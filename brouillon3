import os
import joblib
import pandas as pd
import numpy as np

# Configuration de base
current_folder = os.getcwd()
basepath = os.path.join(current_folder, "Models")

# Charger les modèles, seuils et données
model_load = joblib.load(os.path.join(basepath, "model.pkl"))
best_thresh = joblib.load(os.path.join(basepath, "best_thresh_LightGBM_NS.pkl"))
X_test = pd.read_csv(os.path.join(basepath, "X_test_sample.csv"), index_col=0)
y_test = pd.read_csv(os.path.join(basepath, "y_test_sample.csv"), index_col=0)
_shap_values_ = joblib.load(os.path.join(basepath, "_shap_values_sample_.pkl"))
shap_values1 = pd.read_csv(os.path.join(basepath, "shap_values1_sample.csv"), index_col=0)
clients_a_supprimer = [136718, 307488, 378985]
data = pd.DataFrame(y_test, index=y_test.index).reset_index()
# Supprimer les clients
data = data[~data['SK_ID_CURR'].isin(clients_a_supprimer)]
columns = joblib.load('Models/columns.pkl')          

# Accéder aux valeurs de SHAP pour un client spécifique
for idx in data.index:
    if idx < len(_shap_values_):
        base_value = _shap_values_[idx].base_values  # Accéder à base_values
        print(f"Base value for index {idx}: {base_value}")
    else:
        print(f"Index {idx} is out of bounds for _shap_values_.")